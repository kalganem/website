<!DOCTYPE html>
<html lang="en-us">
<head>
  
  

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/slides/intro_lesson1/lesson6/">

  <title>Lesson 6 | CDRL</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/reveal.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/css/theme/black.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous">

  
  
  
  <link rel="stylesheet" href="/css/reveal_custom.min.css">

  
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/css/print/pdf.css' : 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>

</head>
<body>

  
<div class="reveal">
  <div class="slides">
    
    
    

    
    

    
    

    
    
    
    <section>
    
      


<div id="setup" class="section level1">
<h1>setup</h1>
<p>Load Libraries</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.2.1     ✔ purrr   0.3.2
## ✔ tibble  2.1.3     ✔ dplyr   0.8.3
## ✔ tidyr   1.0.0     ✔ stringr 1.4.0
## ✔ readr   1.3.1     ✔ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div id="generating-random-numbers" class="section level1">
<h1>Generating random numbers</h1>
<p>Normal distribution, n = number of observations, default: mean = 0 and sd = 1</p>
<pre class="r"><code>x &lt;- rnorm(1000)
hist(x)</code></pre>
<p><img src="/scripts/intro-to-coding/lesson6_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>y &lt;- runif(1000, 1, 100)
hist(y)</code></pre>
<p><img src="/scripts/intro-to-coding/lesson6_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="descriptive-statistics" class="section level1">
<h1>Descriptive Statistics</h1>
<p>Cacluate mean, standard devation, minimum value, maximum value, range, variation</p>
<pre class="r"><code>mean(y)</code></pre>
<pre><code>## [1] 49.53925</code></pre>
<pre class="r"><code>sd(y)</code></pre>
<pre><code>## [1] 28.71923</code></pre>
<pre class="r"><code>min(y)</code></pre>
<pre><code>## [1] 1.30469</code></pre>
<pre class="r"><code>max(y)</code></pre>
<pre><code>## [1] 99.83657</code></pre>
<pre class="r"><code>range(y)</code></pre>
<pre><code>## [1]  1.30469 99.83657</code></pre>
<pre class="r"><code>var(y)</code></pre>
<pre><code>## [1] 824.794</code></pre>
<p>Caclulate descriptive statistics on a data frame</p>
<pre class="r"><code>d &lt;- data.frame(Normal = x, Uniform = y)  %&gt;% gather(Dist, Value,1:2) 
  
d %&gt;% group_by(Dist) %&gt;% 
  summarise(
            N = n(),
            Avg = mean(Value), 
            SD = sd(Value),
            min = min(Value),
            max = max(Value),
            Var = var(Value)
            ) </code></pre>
<pre><code>## # A tibble: 2 x 7
##   Dist        N      Avg     SD   min   max     Var
##   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 Normal   1000 -0.00762  0.991 -3.48  3.37   0.982
## 2 Uniform  1000 49.5     28.7    1.30 99.8  825.</code></pre>
</div>
<div id="normality-tests" class="section level1">
<h1>Normality tests</h1>
<pre class="r"><code>shapiro.test(x)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x
## W = 0.99873, p-value = 0.7109</code></pre>
<pre class="r"><code>shapiro.test(y)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  y
## W = 0.95525, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="correlation-analysis" class="section level1">
<h1>Correlation analysis</h1>
<pre class="r"><code>Age &lt;- c(6,8,9,11,15,16,20,25)
Height &lt;- c(110,120,125,133,155,160,180,175)
cor(Age,Height, method = &quot;pearson&quot;)</code></pre>
<pre><code>## [1] 0.9574954</code></pre>
<pre class="r"><code>cor.test(Age,Height, method = &quot;pearson&quot;)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Age and Height
## t = 8.131, df = 6, p-value = 0.0001859
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7772483 0.9925046
## sample estimates:
##       cor 
## 0.9574954</code></pre>
</div>
<div id="t-test" class="section level1">
<h1>T-test</h1>
<p>one-sample t-test</p>
<pre class="r"><code>t.test(x, mu = 5)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  x
## t = -159.8, df = 999, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 5
## 95 percent confidence interval:
##  -0.06911695  0.05387050
## sample estimates:
##    mean of x 
## -0.007623223</code></pre>
<p>unpaired two samples t-test</p>
<pre class="r"><code>A_weight &lt;- c(38.9, 61.2, 73.3, 21.8, 63.4, 64.6, 48.4, 48.8, 48.5)
B_weight &lt;- c(67.8, 60, 63.4, 76, 89.4, 73.3, 67.3, 61.3, 62.4)

var.test(A_weight,B_weight)</code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  A_weight and B_weight
## F = 2.7675, num df = 8, denom df = 8, p-value = 0.1714
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##   0.6242536 12.2689506
## sample estimates:
## ratio of variances 
##           2.767478</code></pre>
<pre class="r"><code>t.test(A_weight,B_weight, var.equal = T)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  A_weight and B_weight
## t = -2.7842, df = 16, p-value = 0.01327
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -29.748019  -4.029759
## sample estimates:
## mean of x mean of y 
##  52.10000  68.98889</code></pre>
<pre class="r"><code>t.test(A_weight,B_weight, var.equal = T)$p.value</code></pre>
<pre><code>## [1] 0.0132656</code></pre>
<p>paired two samples test</p>
<pre class="r"><code>weight_before &lt;- c(200.1, 190.9, 192.7, 213, 241.4, 196.9, 172.2, 185.5, 205.2, 193.7)
weight_after &lt;- c(392.9, 393.2, 345.1, 393, 434, 427.9, 422, 383.9, 392.3, 352.2)

t.test(weight_before, weight_after, paired = TRUE)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  weight_before and weight_after
## t = -20.883, df = 9, p-value = 6.2e-09
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -215.5581 -173.4219
## sample estimates:
## mean of the differences 
##                 -194.49</code></pre>
</div>
<div id="anova" class="section level1">
<h1>ANOVA</h1>
<p>one way ANOVA</p>
<pre class="r"><code>d2 &lt;- data.frame(Group1 = c(7,6,8,6),
                 Group2 = c(9,9,7,8),
                 Group3 = c(3,5,6,5)) %&gt;% gather(Group, Value, 1:3)

res &lt;- aov(Value ~ Group, data = d2)

summary(res)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Group        2  24.67  12.333   10.83 0.00402 **
## Residuals    9  10.25   1.139                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>to test which means are different</p>
<pre class="r"><code>TukeyHSD(res)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Value ~ Group, data = d2)
## 
## $Group
##               diff        lwr        upr     p adj
## Group2-Group1  1.5 -0.6068905  3.6068905 0.1708486
## Group3-Group1 -2.0 -4.1068905  0.1068905 0.0623473
## Group3-Group2 -3.5 -5.6068905 -1.3931095 0.0031408</code></pre>
<pre class="r"><code>pairwise.t.test(d2$Value,d2$Group,
                p.adjust.method = &quot;BH&quot;)</code></pre>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  d2$Value and d2$Group 
## 
##        Group1 Group2
## Group2 0.0781 -     
## Group3 0.0397 0.0037
## 
## P value adjustment method: BH</code></pre>
<p>Two way ANOVA
d3 &lt;- read.csv(“cycls2.csv”)</p>
<p>d3<span class="math inline">\(dose &lt;- factor(d3\)</span>dose)
d3<span class="math inline">\(subj &lt;- factor(d3\)</span>subj)</p>
<p>av = aov(min ~ dose + subj, data=d3)</p>
<p>summary(av)</p>
<pre class="r"><code>power.t.test(n=NULL, delta=10, sd=30, sig.level=0.05, power=0.80,
             type= &quot;one.sample&quot;, alternative=&quot;two.sided&quot;)</code></pre>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 72.58407
##           delta = 10
##              sd = 30
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided</code></pre>
<pre class="r"><code>power.t.test(n=NULL, delta=15, sd=20, sig.level=0.05, power=0.80,
             type= &quot;two.sample&quot;, alternative=&quot;two.sided&quot;)</code></pre>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 28.89962
##           delta = 15
##              sd = 20
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<pre class="r"><code>power.t.test(n=100, delta=10, sd=40, sig.level=0.05, power=NULL,
             type= &quot;paired&quot;, alternative=&quot;two.sided&quot;)</code></pre>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 100
##           delta = 10
##              sd = 40
##       sig.level = 0.05
##           power = 0.6969757
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*, sd is std.dev. of *differences* within pairs</code></pre>
</div>

    </section>
    

    
    
  </div>
</div>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/lib/js/head.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/js/reveal.min.js"></script>

  <script>
    window.revealPlugins = { dependencies: [
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/zoom-js/zoom.js', async: true },
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/math/math.js', async: true },
      { src: 'https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/reveal.js\/3.8.0/plugin/print-pdf/print-pdf.js', async: true },
      
      { src: '\/js\/vendor\/reveal.js\/plugin\/notes\/notes.js', async: true }
    ]};

    let revealDefaults = { center: true, controls: true, history: true, progress: true, transition: 'slide', mouseWheel: true };
    let revealOptions = Object.assign({}, revealDefaults, revealPlugins);
    Reveal.initialize(revealOptions);
  </script>

</body>
</html>
